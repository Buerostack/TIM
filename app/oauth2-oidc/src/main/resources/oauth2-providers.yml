providers:
  google:
    name: "Google OAuth2"
    discovery_url: "https://accounts.google.com/.well-known/openid-configuration"
    client_id: "${GOOGLE_CLIENT_ID:your-google-client-id}"
    client_secret: "${GOOGLE_CLIENT_SECRET:your-google-client-secret}"
    enabled: true
    scopes:
      - "openid"
      - "profile"
      - "email"
    claim_mappings:
      firstName: "given_name"
      lastName: "family_name"
      email: "email"
      emailVerified: "email_verified"
      avatarUrl: "picture"
    custom_claims:
      - "email_verified"
      - "picture"
    health_check_interval: 300
    token_validation:
      clock_skew_seconds: 60
      cache_ttl_seconds: 3600

  tara:
    name: "TARA Estonia"
    discovery_url: "https://tara-test.ria.ee/oidc/.well-known/openid-configuration"
    client_id: "${TARA_CLIENT_ID:your-tara-client-id}"
    client_secret: "${TARA_CLIENT_SECRET:your-tara-client-secret}"
    enabled: true
    scopes:
      - "openid"
      - "idcard"
      - "mid"
      - "smartid"
    claim_mappings:
      firstName: "given_name"
      lastName: "family_name"
      nationalId: "personalcode"
      authenticationMethod: "amr[0]"  # Extract first element from array
      levelOfAssurance: "acr"
    custom_claims:
      - "personalcode"
      - "amr"
      - "acr"
    custom_parameters:
      ui_locales: "et,en"
    adapter_class: "TaraProviderAdapter"  # Custom adapter for complex logic
    health_check_interval: 180  # More frequent for TARA due to short token validity
    token_validation:
      clock_skew_seconds: 30  # Stricter for TARA's short-lived tokens
      cache_ttl_seconds: 1800  # Shorter cache for TARA

  azure:
    name: "Azure AD / Microsoft Entra ID"
    discovery_url: "https://login.microsoftonline.com/${AZURE_TENANT_ID:common}/v2.0/.well-known/openid-configuration"
    client_id: "${AZURE_CLIENT_ID:your-azure-client-id}"
    client_secret: "${AZURE_CLIENT_SECRET:your-azure-client-secret}"
    enabled: false  # Disabled by default
    scopes:
      - "openid"
      - "profile"
      - "email"
    claim_mappings:
      firstName: "given_name"
      lastName: "family_name"
      email: "email"
      userPrincipalName: "upn"
      objectId: "oid"
    custom_claims:
      - "upn"
      - "oid"
      - "tenant_id"
    health_check_interval: 300
    token_validation:
      clock_skew_seconds: 60
      cache_ttl_seconds: 3600

  # Example configuration for other providers
  okta:
    name: "Okta"
    discovery_url: "https://${OKTA_DOMAIN:your-okta-domain}/.well-known/openid-configuration"
    client_id: "${OKTA_CLIENT_ID:your-okta-client-id}"
    client_secret: "${OKTA_CLIENT_SECRET:your-okta-client-secret}"
    enabled: false
    scopes:
      - "openid"
      - "profile"
      - "email"
    claim_mappings:
      firstName: "given_name"
      lastName: "family_name"
      email: "email"
    health_check_interval: 300
    token_validation:
      clock_skew_seconds: 60
      cache_ttl_seconds: 3600

  auth0:
    name: "Auth0"
    discovery_url: "https://${AUTH0_DOMAIN:your-auth0-domain}/.well-known/openid-configuration"
    client_id: "${AUTH0_CLIENT_ID:your-auth0-client-id}"
    client_secret: "${AUTH0_CLIENT_SECRET:your-auth0-client-secret}"
    enabled: false
    scopes:
      - "openid"
      - "profile"
      - "email"
    claim_mappings:
      firstName: "given_name"
      lastName: "family_name"
      email: "email"
    health_check_interval: 300
    token_validation:
      clock_skew_seconds: 60
      cache_ttl_seconds: 3600